2022-06-02 13:29:45,670-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 1
2022-06-02 13:29:50,681-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 2
2022-06-02 13:29:55,692-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 3
2022-06-02 13:30:00,682-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 4
2022-06-02 13:30:05,692-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 5
2022-06-02 13:31:33,272-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 1
2022-06-02 13:32:23,821-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 1
2022-06-02 13:32:28,813-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 2
2022-06-02 13:32:33,828-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 3
2022-06-02 13:32:38,842-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 4
2022-06-02 13:32:43,855-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 5
2022-06-02 13:34:06,672-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 1
2022-06-02 13:34:57,280-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 1
2022-06-02 13:35:02,300-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 2
2022-06-02 13:35:07,316-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 3
2022-06-02 13:35:51,660-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 1
2022-06-02 13:35:56,673-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 2
2022-06-02 13:36:01,662-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 3
2022-06-02 13:36:06,675-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 4
2022-06-02 13:36:11,686-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 5
2022-06-02 13:37:00,640-ERROR-modelProducerLog-1::db|44:: got error could not translate host name "data_cleaning_db" to address: Name or service not known. reconnecting 1
2022-06-02 13:37:05,661-ERROR-modelProducerLog-1::db|44:: got error could not translate host name "data_cleaning_db" to address: Name or service not known. reconnecting 2
2022-06-02 13:37:10,678-ERROR-modelProducerLog-1::db|44:: got error could not translate host name "data_cleaning_db" to address: Name or service not known. reconnecting 3
2022-06-02 13:37:20,764-ERROR-modelProducerLog-1::db|44:: got error could not translate host name "data_cleaning_db" to address: Name or service not known. reconnecting 1
2022-06-02 13:37:25,788-ERROR-modelProducerLog-1::db|44:: got error could not translate host name "data_cleaning_db" to address: Name or service not known. reconnecting 2
2022-06-02 13:37:30,781-ERROR-modelProducerLog-1::db|44:: got error could not translate host name "data_cleaning_db" to address: Name or service not known. reconnecting 3
2022-06-02 14:00:24,441-ERROR-modelProducerLog-1::db|44:: got error could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?. reconnecting 1
2022-06-04 12:30:56,614-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: Parameter grid for parameter 'classifier' needs to be a list or a numpy array, but got BalancedRandomForestClassifier() (of type BalancedRandomForestClassifier) instead. Single values need to be wrapped in a list with one element.
2022-06-04 12:30:56,621-ERROR-modelProducerLog-1::pipeline_runner|44:: concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/concurrent/futures/process.py", line 246, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 118, in __init__
    raise TypeError(
TypeError: Parameter grid for parameter 'classifier' needs to be a list or a numpy array, but got BalancedRandomForestClassifier() (of type BalancedRandomForestClassifier) instead. Single values need to be wrapped in a list with one element.
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 63, in __run_pipelines
    if not f.result():
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
TypeError: Parameter grid for parameter 'classifier' needs to be a list or a numpy array, but got BalancedRandomForestClassifier() (of type BalancedRandomForestClassifier) instead. Single values need to be wrapped in a list with one element.

2022-06-04 12:31:08,422-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: Parameter grid for parameter 'classifier' needs to be a list or a numpy array, but got BalancedRandomForestClassifier() (of type BalancedRandomForestClassifier) instead. Single values need to be wrapped in a list with one element.
2022-06-04 12:31:08,429-ERROR-modelProducerLog-1::pipeline_runner|44:: concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/concurrent/futures/process.py", line 246, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 118, in __init__
    raise TypeError(
TypeError: Parameter grid for parameter 'classifier' needs to be a list or a numpy array, but got BalancedRandomForestClassifier() (of type BalancedRandomForestClassifier) instead. Single values need to be wrapped in a list with one element.
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 63, in __run_pipelines
    if not f.result():
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
TypeError: Parameter grid for parameter 'classifier' needs to be a list or a numpy array, but got BalancedRandomForestClassifier() (of type BalancedRandomForestClassifier) instead. Single values need to be wrapped in a list with one element.

2022-06-04 12:46:59,294-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'

2022-06-04 12:46:59,308-ERROR-modelProducerLog-1::pipeline_runner|44:: concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/concurrent/futures/process.py", line 246, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/app/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'

"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 63, in __run_pipelines
    if not f.result():
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
ValueError: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'


2022-06-04 12:52:16,682-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'

2022-06-04 12:52:16,694-ERROR-modelProducerLog-1::pipeline_runner|44:: concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/concurrent/futures/process.py", line 246, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/app/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'

"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 63, in __run_pipelines
    if not f.result():
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
ValueError: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'


2022-06-04 12:57:54,414-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000298 , err: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'

2022-06-04 12:57:54,425-ERROR-modelProducerLog-1::pipeline_runner|44:: concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/concurrent/futures/process.py", line 246, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/app/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'

"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 63, in __run_pipelines
    if not f.result():
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
ValueError: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'


2022-06-04 13:08:45,887-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'

2022-06-04 13:08:45,909-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'


2022-06-04 13:09:00,410-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'

2022-06-04 13:09:00,419-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'


2022-06-04 13:09:36,852-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000298 , err: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'

2022-06-04 13:09:36,862-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 45 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
45 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py", line 331, in fit
    X, y = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 596, in _validate_data
    X, y = check_X_y(X, y, **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1074, in check_X_y
    X = check_array(
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
ValueError: could not convert string to float: 'P'


2022-06-04 13:15:17,875-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
4 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=True

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0

2022-06-04 13:15:17,883-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
4 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=True

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0


2022-06-04 13:16:25,733-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=True

2022-06-04 13:16:25,744-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 97, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 155, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=True


2022-06-04 13:19:10,187-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000298 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=True

2022-06-04 13:19:10,203-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 48, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 97, in evaluate_classifiers
    _confusion_matrix = metrics.confusion_matrix(y_test, y_pred)
  File "/app/service/classification_pipeline.py", line 155, in train_model_grid
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=True


2022-06-04 13:42:32,493-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: [Errno 2] No such file or directory: 'client-plots/1000001/RandomForestClassifier_04/06/2022_13:42:32.png'
2022-06-04 13:42:32,505-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 111, in evaluate_classifiers
    plt.savefig(f"client-plots/{self.ad_client_id}/{str(type(classifier_params['classifier'][0]).__name__)}_{current_dt}.png")
  File "/usr/local/lib/python3.9/site-packages/matplotlib/pyplot.py", line 979, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'client-plots/1000001/RandomForestClassifier_04/06/2022_13:42:32.png'

2022-06-04 13:44:00,064-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: [Errno 2] No such file or directory: 'client-plots/1000005/RandomForestClassifier_04/06/2022_13:44:00.png'
2022-06-04 13:44:00,070-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/app/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 111, in evaluate_classifiers
    plt.savefig(f"client-plots/{self.ad_client_id}/{str(type(classifier_params['classifier'][0]).__name__)}_{current_dt}.png")
  File "/usr/local/lib/python3.9/site-packages/matplotlib/pyplot.py", line 979, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'client-plots/1000005/RandomForestClassifier_04/06/2022_13:44:00.png'

2022-06-04 19:53:23,963-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: [Errno 2] No such file or directory: 'client-plots/1000001/RandomForestClassifier_04/06/2022.png'
2022-06-04 19:53:23,977-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 111, in evaluate_classifiers
    plt.savefig(f"client-plots/{self.ad_client_id}/{str(type(classifier_params['classifier'][0]).__name__)}_{current_dt}.png")
  File "/usr/local/lib/python3.9/site-packages/matplotlib/pyplot.py", line 979, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'client-plots/1000001/RandomForestClassifier_04/06/2022.png'

2022-06-04 19:55:06,775-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: [Errno 2] No such file or directory: 'client-plots/1000001/RandomForestClassifier_04/06/2022.png'
2022-06-04 19:55:06,791-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 111, in evaluate_classifiers
    plt.savefig(f"client-plots/{self.ad_client_id}/{str(type(classifier_params['classifier'][0]).__name__)}_{current_dt}.png")
  File "/usr/local/lib/python3.9/site-packages/matplotlib/pyplot.py", line 979, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'client-plots/1000001/RandomForestClassifier_04/06/2022.png'

2022-06-04 19:55:54,463-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: [Errno 2] No such file or directory: 'client-plots/1000001/04/06/2022.png'
2022-06-04 19:55:54,479-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 111, in evaluate_classifiers
    plt.savefig(f"client-plots/{self.ad_client_id}/{current_dt}.png")
  File "/usr/local/lib/python3.9/site-packages/matplotlib/pyplot.py", line 979, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'client-plots/1000001/04/06/2022.png'

2022-06-04 19:56:58,337-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: [Errno 2] No such file or directory: 'client-plots/1000005/04/06/2022.png'
2022-06-04 19:56:58,347-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 111, in evaluate_classifiers
    plt.savefig(f"client-plots/{self.ad_client_id}/{current_dt}.png")
  File "/usr/local/lib/python3.9/site-packages/matplotlib/pyplot.py", line 979, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'client-plots/1000005/04/06/2022.png'

2022-06-04 19:58:35,503-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: [Errno 2] No such file or directory: 'client-plots/1000001/RandomForestClassifier_04/06/2022_19:58:35.png'
2022-06-04 19:58:35,512-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 112, in evaluate_classifiers
    plt.savefig(os.path.join(output_folder, f"{str(type(classifier_params['classifier'][0]).__name__)}_{current_dt}.png"))
  File "/usr/local/lib/python3.9/site-packages/matplotlib/pyplot.py", line 979, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'client-plots/1000001/RandomForestClassifier_04/06/2022_19:58:35.png'

2022-06-04 20:45:26,619-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: Found input variables with inconsistent numbers of samples: [6, 7278]
2022-06-04 20:45:26,631-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 99, in evaluate_classifiers
    fpr, tpr, _ = metrics.roc_curve([1,0,0,1,-1,-1], y_pred, pos_label=2)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 979, in roc_curve
    fps, tps, thresholds = _binary_clf_curve(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 740, in _binary_clf_curve
    check_consistent_length(y_true, y_score, sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 387, in check_consistent_length
    raise ValueError(
ValueError: Found input variables with inconsistent numbers of samples: [6, 7278]

2022-06-04 20:50:50,967-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 'RocCurveDisplay' object has no attribute 'savefig'
2022-06-04 20:50:50,980-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 113, in evaluate_classifiers
    plt.savefig(f"client-plots/{self.ad_client_id}/{str(type(classifier_params['classifier'][0]).__name__)}_{current_dt}.png")
AttributeError: 'RocCurveDisplay' object has no attribute 'savefig'

2022-06-04 20:51:53,713-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 'RocCurveDisplay' object has no attribute 'savefig'
2022-06-04 20:51:53,729-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 114, in evaluate_classifiers
    plt.savefig(f"client-plots/{self.ad_client_id}/{str(type(classifier_params['classifier'][0]).__name__)}_{current_dt}.png")
AttributeError: 'RocCurveDisplay' object has no attribute 'savefig'

2022-06-04 20:53:36,128-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 'Figure' object has no attribute 'close'
2022-06-04 20:53:36,133-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 115, in evaluate_classifiers
    plt.close()
AttributeError: 'Figure' object has no attribute 'close'

2022-06-04 21:00:46,469-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
4 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=True

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0

2022-06-04 21:00:46,484-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 100, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 172, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
4 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=True

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0


2022-06-04 21:02:32,724-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: Invalid parameter 'dual' for estimator Pipeline(steps=[('column_transformer',
                 ColumnTransformer(remainder='passthrough',
                                   transformers=[('num',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(fill_value=0,
                                                                                 strategy='constant')),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                                                   10, 11, 12, 13, 14, 15, 16,
                                                   17, 18, 19, 20, 21, 22, 23,
                                                   24, 25, 26, 27]),
                                                 ('cat',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(fill_value='Missing',
                                                                                 strategy='constant')),
                                                                  ('onehot',
                                                                   OneHotEncoder(handle_unknown='ignore',
                                                                                 sparse=False))]),
                                                  [28, 29])])),
                ('classifier', LinearSVC())]). Valid parameters are: ['memory', 'steps', 'verbose'].
2022-06-04 21:02:32,738-ERROR-modelProducerLog-1::pipeline_runner|44:: joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/joblib/externals/loky/process_executor.py", line 436, in _process_worker
    r = call_item()
  File "/usr/local/lib/python3.9/site-packages/joblib/externals/loky/process_executor.py", line 288, in __call__
    return self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 595, in __call__
    return self.func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 674, in _fit_and_score
    estimator = estimator.set_params(**cloned_parameters)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 188, in set_params
    self._set_params("steps", **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/metaestimators.py", line 72, in _set_params
    super().set_params(**params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 246, in set_params
    raise ValueError(
ValueError: Invalid parameter 'dual' for estimator Pipeline(steps=[('column_transformer',
                 ColumnTransformer(remainder='passthrough',
                                   transformers=[('num',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(fill_value=0,
                                                                                 strategy='constant')),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                                                   10, 11, 12, 13, 14, 15, 16,
                                                   17, 18, 19, 20, 21, 22, 23,
                                                   24, 25, 26, 27]),
                                                 ('cat',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(fill_value='Missing',
                                                                                 strategy='constant')),
                                                                  ('onehot',
                                                                   OneHotEncoder(handle_unknown='ignore',
                                                                                 sparse=False))]),
                                                  [28, 29])])),
                ('classifier', LinearSVC())]). Valid parameters are: ['memory', 'steps', 'verbose'].
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 101, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 173, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 822, in evaluate_candidates
    out = parallel(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1056, in __call__
    self.retrieve()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 935, in retrieve
    self._output.extend(job.get(timeout=self.timeout))
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 542, in wrap_future_result
    return future.result(timeout=timeout)
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 446, in result
    return self.__get_result()
  File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
ValueError: Invalid parameter 'dual' for estimator Pipeline(steps=[('column_transformer',
                 ColumnTransformer(remainder='passthrough',
                                   transformers=[('num',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(fill_value=0,
                                                                                 strategy='constant')),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                                                   10, 11, 12, 13, 14, 15, 16,
                                                   17, 18, 19, 20, 21, 22, 23,
                                                   24, 25, 26, 27]),
                                                 ('cat',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(fill_value='Missing',
                                                                                 strategy='constant')),
                                                                  ('onehot',
                                                                   OneHotEncoder(handle_unknown='ignore',
                                                                                 sparse=False))]),
                                                  [28, 29])])),
                ('classifier', LinearSVC())]). Valid parameters are: ['memory', 'steps', 'verbose'].

2022-06-04 21:03:23,021-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
4 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=False

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0

2022-06-04 21:03:23,034-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 101, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 173, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
4 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=False

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0


2022-06-05 10:30:57,729-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
4 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=False

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0

2022-06-05 10:30:57,744-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 101, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 173, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
4 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1204, in _fit_liblinear
    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1043, in _get_liblinear_solver_type
    raise ValueError(
ValueError: Unsupported set of arguments: The combination of penalty='12' and loss='squared_hinge' is not supported, Parameters: penalty=12, loss='squared_hinge', dual=False

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0


2022-06-05 10:50:06,332-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: float() argument must be a string or a number, not 'Timestamp'
2022-06-05 10:50:06,346-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 48, in __init__
    self.__data = StandardScaler().fit_transform(df)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/preprocessing/_data.py", line 809, in fit
    return self.partial_fit(X, y, sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/preprocessing/_data.py", line 844, in partial_fit
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 1993, in __array__
    return np.asarray(self._values, dtype=dtype)
TypeError: float() argument must be a string or a number, not 'Timestamp'

2022-06-05 10:50:13,681-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: float() argument must be a string or a number, not 'Timestamp'
2022-06-05 10:50:13,687-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 48, in __init__
    self.__data = StandardScaler().fit_transform(df)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/preprocessing/_data.py", line 809, in fit
    return self.partial_fit(X, y, sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/preprocessing/_data.py", line 844, in partial_fit
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 1993, in __array__
    return np.asarray(self._values, dtype=dtype)
TypeError: float() argument must be a string or a number, not 'Timestamp'

2022-06-05 10:52:30,717-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: 'ClassificationPipeline' object has no attribute '_ClassificationPipeline__data'
2022-06-05 10:52:30,730-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 52, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 64, in split_for_test
    x_train = self.__data[self.__data['dateinvoiced'] <= self.__data['dateinvoiced'].max() + timedelta(days=-365 * n_years)][features]
AttributeError: 'ClassificationPipeline' object has no attribute '_ClassificationPipeline__data'

2022-06-05 10:52:38,205-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: 'ClassificationPipeline' object has no attribute '_ClassificationPipeline__data'
2022-06-05 10:52:38,208-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 52, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 64, in split_for_test
    x_train = self.__data[self.__data['dateinvoiced'] <= self.__data['dateinvoiced'].max() + timedelta(days=-365 * n_years)][features]
AttributeError: 'ClassificationPipeline' object has no attribute '_ClassificationPipeline__data'

2022-06-05 11:12:07,520-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: Length mismatch: Expected axis has 74823 elements, new values have 74314 elements
2022-06-05 11:12:07,534-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 59, in __init__
    df1.index = df1ind
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 74823 elements, new values have 74314 elements

2022-06-05 11:12:20,719-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000298 , err: Length mismatch: Expected axis has 110404 elements, new values have 107624 elements
2022-06-05 11:12:20,728-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 59, in __init__
    df1.index = df1ind
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 110404 elements, new values have 107624 elements

2022-06-05 11:26:05,419-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: Length mismatch: Expected axis has 74823 elements, new values have 74314 elements
2022-06-05 11:26:05,433-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 59, in __init__
    df1.index = df1ind
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 74823 elements, new values have 74314 elements

2022-06-05 11:26:18,429-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000298 , err: Length mismatch: Expected axis has 110404 elements, new values have 107624 elements
2022-06-05 11:26:18,433-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 65, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 59, in __init__
    df1.index = df1ind
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 110404 elements, new values have 107624 elements

2022-06-05 11:50:56,723-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: Length mismatch: Expected axis has 74823 elements, new values have 74314 elements
2022-06-05 11:50:56,737-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 53, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 59, in __init__
    df1.index = df1ind
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 74823 elements, new values have 74314 elements

2022-06-05 11:54:35,923-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: Length mismatch: Expected axis has 18358 elements, new values have 88 elements
2022-06-05 11:54:35,937-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 53, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 53, in __init__
    df1.index = (list(range(0, A, int(len(df1) / (len(df2) - 1)))))
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 18358 elements, new values have 88 elements

2022-06-05 11:57:00,956-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000001 , err: Length mismatch: Expected axis has 18358 elements, new values have 4612 elements
2022-06-05 11:57:00,970-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 53, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 53, in __init__
    df1.index = (list(range(0, A, 4)))
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 18358 elements, new values have 4612 elements

2022-06-05 12:00:55,122-ERROR-modelProducerLog-1::pipeline_runner|43:: Unable to run pipelines for client: 1000005 , err: Length mismatch: Expected axis has 74823 elements, new values have 74314 elements
2022-06-05 12:00:55,139-ERROR-modelProducerLog-1::pipeline_runner|44:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 41, in run
    state_map[ad_client_id] = PipelineRunner.__run_pipelines(cleaned_data, ad_client_id)
  File "/opt/project/model-producer/service/pipeline_runner.py", line 53, in __run_pipelines
    classification_pipeline = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 59, in __init__
    df1.index = df1ind
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 74823 elements, new values have 74314 elements

2022-06-05 12:42:24,488-ERROR-modelProducerLog-14::pipeline_runner|68:: Error in classification pipeline for client: 1000001 , err: [Errno 2] No such file or directory: 'ml-models/classification_models/1000001/05-06-2022_12:42:24.sav'
2022-06-05 12:42:24,495-ERROR-modelProducerLog-14::pipeline_runner|69:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 66, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 70, in run
    self.persist_model(model)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 211, in persist_model
    with open(f'ml-models/classification_models/{self.ad_client_id}/{current_dt}.sav') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'ml-models/classification_models/1000001/05-06-2022_12:42:24.sav'

2022-06-05 12:42:25,884-ERROR-modelProducerLog-14::pipeline_runner|74:: Error in regression pipeline for client: 1000001 , err: [Errno 2] No such file or directory: 'ml-models/regression_models/1000001/05-06-2022_12:42:25.sav'
2022-06-05 12:42:25,889-ERROR-modelProducerLog-14::pipeline_runner|75:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 72, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 54, in run
    self.persist_model(generated_model)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 172, in persist_model
    with open(f'ml-models/regression_models/{self.ad_client_id}/{current_dt}.sav') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'ml-models/regression_models/1000001/05-06-2022_12:42:25.sav'

2022-06-05 12:53:57,080-ERROR-modelProducerLog-1::pipeline_runner|68:: Error in classification pipeline for client: 1000298 , err: Length mismatch: Expected axis has 110404 elements, new values have 107624 elements
2022-06-05 12:53:57,095-ERROR-modelProducerLog-1::pipeline_runner|69:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 66, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 59, in __init__
    df1.index = df1ind
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 110404 elements, new values have 107624 elements

2022-06-05 13:10:55,616-ERROR-modelProducerLog-1::pipeline_runner|68:: Error in classification pipeline for client: 1000298 , err: Length mismatch: Expected axis has 110404 elements, new values have 107624 elements
2022-06-05 13:10:55,636-ERROR-modelProducerLog-1::pipeline_runner|69:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 66, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 59, in __init__
    df1.index = df1ind
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 110404 elements, new values have 107624 elements

2022-06-06 11:44:45,499-ERROR-modelProducerLog-1::pipeline_runner|54:: Error in classification pipeline for client: 1000001 , err: RocCurveDisplay.from_estimator requires matplotlib. You can install matplotlib with `pip install matplotlib`
2022-06-06 11:44:45,512-ERROR-modelProducerLog-1::pipeline_runner|55:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/__init__.py", line 1118, in check_matplotlib_support
    import matplotlib  # noqa
ModuleNotFoundError: No module named 'matplotlib'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 52, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 79, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 145, in evaluate_classifiers
    display = RocCurveDisplay.from_estimator(grid.best_estimator_, x_test, y_test)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_plot/roc_curve.py", line 227, in from_estimator
    check_matplotlib_support(f"{cls.__name__}.from_estimator")
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/__init__.py", line 1120, in check_matplotlib_support
    raise ImportError(
ImportError: RocCurveDisplay.from_estimator requires matplotlib. You can install matplotlib with `pip install matplotlib`

2022-06-06 18:47:13,372-ERROR-modelProducerLog-1::file_service|71:: [Errno 2] No such file or directory: '../tmp/client_plots'
2022-06-06 18:47:13,378-ERROR-modelProducerLog-1::file_service|76:: [Errno 2] No such file or directory: '../tmp/client_plots/1000001'
2022-06-06 18:47:13,493-ERROR-modelProducerLog-1::pipeline_runner|56:: Error in classification pipeline for client: 1000001 , err: [Errno 2] No such file or directory: '../tmp/client_plots/1000001/RandomForestClassifier_06-06-2022_18:47:13.png'
2022-06-06 18:47:13,511-ERROR-modelProducerLog-1::pipeline_runner|57:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 54, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 80, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 152, in evaluate_classifiers
    file_service.persist_classifier_plot(plt, str(type(classifier_params['classifier'][0]).__name__),
  File "/opt/project/model-producer/service/file_service.py", line 38, in persist_classifier_plot
    plot_path, obj_name = dump_plot_for_client(ad_client_id, plot, classifier_name)
  File "/opt/project/model-producer/service/file_service.py", line 80, in dump_plot_for_client
    plot.savefig(plot_path)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: '../tmp/client_plots/1000001/RandomForestClassifier_06-06-2022_18:47:13.png'

2022-06-06 18:47:15,460-ERROR-modelProducerLog-1::file_service|49:: [Errno 2] No such file or directory: '../tmp/ml-models'
2022-06-06 18:47:15,465-ERROR-modelProducerLog-1::file_service|54:: [Errno 2] No such file or directory: '../tmp/ml-models/regression_models'
2022-06-06 18:47:15,470-ERROR-modelProducerLog-1::file_service|59:: [Errno 2] No such file or directory: '../tmp/ml-models/regression_models/1000001'
2022-06-06 18:47:15,474-ERROR-modelProducerLog-1::pipeline_runner|62:: Error in regression pipeline for client: 1000001 , err: [Errno 2] No such file or directory: "../tmp/ml-models/regression_models/1000001/06-06-2022_18:47:15.sav'"
2022-06-06 18:47:15,480-ERROR-modelProducerLog-1::pipeline_runner|63:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 60, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 56, in run
    self.persist_model(generated_model)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 166, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/opt/project/model-producer/service/file_service.py", line 31, in persist_model
    model_path, obj_name = dump_model_for_client(model_directory, ad_client_id, model)
  File "/opt/project/model-producer/service/file_service.py", line 62, in dump_model_for_client
    pickle.dump(model, open(model_path, 'wb'))
FileNotFoundError: [Errno 2] No such file or directory: "../tmp/ml-models/regression_models/1000001/06-06-2022_18:47:15.sav'"

2022-06-06 18:51:17,278-ERROR-modelProducerLog-1::file_service|71:: [Errno 2] No such file or directory: '../../tmp/client_plots'
2022-06-06 18:51:17,287-ERROR-modelProducerLog-1::file_service|76:: [Errno 2] No such file or directory: '../../tmp/client_plots/1000001'
2022-06-06 18:51:17,345-ERROR-modelProducerLog-1::pipeline_runner|56:: Error in classification pipeline for client: 1000001 , err: [Errno 2] No such file or directory: '../../tmp/client_plots/1000001/RandomForestClassifier_06-06-2022_18:51:17.png'
2022-06-06 18:51:17,357-ERROR-modelProducerLog-1::pipeline_runner|57:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 54, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 80, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 152, in evaluate_classifiers
    file_service.persist_classifier_plot(plt, str(type(classifier_params['classifier'][0]).__name__),
  File "/opt/project/model-producer/service/file_service.py", line 38, in persist_classifier_plot
    plot_path, obj_name = dump_plot_for_client(ad_client_id, plot, classifier_name)
  File "/opt/project/model-producer/service/file_service.py", line 80, in dump_plot_for_client
    plot.savefig(plot_path)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: '../../tmp/client_plots/1000001/RandomForestClassifier_06-06-2022_18:51:17.png'

2022-06-06 18:51:18,674-ERROR-modelProducerLog-1::file_service|49:: [Errno 2] No such file or directory: '../../tmp/ml-models'
2022-06-06 18:51:18,678-ERROR-modelProducerLog-1::file_service|54:: [Errno 2] No such file or directory: '../../tmp/ml-models/regression_models'
2022-06-06 18:51:18,683-ERROR-modelProducerLog-1::file_service|59:: [Errno 2] No such file or directory: '../../tmp/ml-models/regression_models/1000001'
2022-06-06 18:51:18,686-ERROR-modelProducerLog-1::pipeline_runner|62:: Error in regression pipeline for client: 1000001 , err: [Errno 2] No such file or directory: "../../tmp/ml-models/regression_models/1000001/06-06-2022_18:51:18.sav'"
2022-06-06 18:51:18,693-ERROR-modelProducerLog-1::pipeline_runner|63:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 60, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 56, in run
    self.persist_model(generated_model)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 166, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/opt/project/model-producer/service/file_service.py", line 31, in persist_model
    model_path, obj_name = dump_model_for_client(model_directory, ad_client_id, model)
  File "/opt/project/model-producer/service/file_service.py", line 62, in dump_model_for_client
    pickle.dump(model, open(model_path, 'wb'))
FileNotFoundError: [Errno 2] No such file or directory: "../../tmp/ml-models/regression_models/1000001/06-06-2022_18:51:18.sav'"

2022-06-06 19:00:23,907-ERROR-modelProducerLog-1::pipeline_runner|56:: Error in classification pipeline for client: 1000001 , err: Failed to upload /opt/project/model-producer/service/../tmp/ml-models/classification_models/1000001/06-06-2022_19:00:23.sav' to ml-cashflow-forecast/client_models/06-06-2022_19:00:23.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-06 19:00:23,921-ERROR-modelProducerLog-1::pipeline_runner|57:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 288, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 103, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 266, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 139, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 162, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 758, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 508, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 911, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 54, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 84, in run
    self.persist_model(model)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 216, in persist_model
    file_service.persist_model(PipelineType.CLASSIFICATION, model, self.ad_client_id)
  File "/opt/project/model-producer/service/file_service.py", line 35, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key, object_name=obj_name):
  File "/opt/project/model-producer/service/file_service.py", line 112, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 143, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 294, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /opt/project/model-producer/service/../tmp/ml-models/classification_models/1000001/06-06-2022_19:00:23.sav' to ml-cashflow-forecast/client_models/06-06-2022_19:00:23.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-06 19:00:25,964-ERROR-modelProducerLog-1::pipeline_runner|62:: Error in regression pipeline for client: 1000001 , err: Failed to upload /opt/project/model-producer/service/../tmp/ml-models/regression_models/1000001/06-06-2022_19:00:25.sav' to ml-cashflow-forecast/client_models/06-06-2022_19:00:25.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-06 19:00:25,970-ERROR-modelProducerLog-1::pipeline_runner|63:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 288, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 103, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 266, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 139, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 162, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 758, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 508, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 911, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 60, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 56, in run
    self.persist_model(generated_model)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 166, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/opt/project/model-producer/service/file_service.py", line 35, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key, object_name=obj_name):
  File "/opt/project/model-producer/service/file_service.py", line 112, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 143, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 294, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /opt/project/model-producer/service/../tmp/ml-models/regression_models/1000001/06-06-2022_19:00:25.sav' to ml-cashflow-forecast/client_models/06-06-2022_19:00:25.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-06 19:01:23,833-ERROR-modelProducerLog-1::file_service|73:: [Errno 2] No such file or directory: '/opt/project/model-producer/service/../../tmp/client_plots'
2022-06-06 19:01:23,843-ERROR-modelProducerLog-1::file_service|78:: [Errno 2] No such file or directory: '/opt/project/model-producer/service/../../tmp/client_plots/1000001'
2022-06-06 19:01:23,904-ERROR-modelProducerLog-1::pipeline_runner|56:: Error in classification pipeline for client: 1000001 , err: [Errno 2] No such file or directory: '/opt/project/model-producer/service/../../tmp/client_plots/1000001/RandomForestClassifier_06-06-2022_19:01:23.png'
2022-06-06 19:01:23,916-ERROR-modelProducerLog-1::pipeline_runner|57:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 54, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 80, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 152, in evaluate_classifiers
    file_service.persist_classifier_plot(plt, str(type(classifier_params['classifier'][0]).__name__),
  File "/opt/project/model-producer/service/file_service.py", line 40, in persist_classifier_plot
    plot_path, obj_name = dump_plot_for_client(ad_client_id, plot, classifier_name)
  File "/opt/project/model-producer/service/file_service.py", line 82, in dump_plot_for_client
    plot.savefig(plot_path)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3046, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2319, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1648, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 415, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 541, in print_png
    mpl.image.imsave(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/image.py", line 1675, in imsave
    image.save(fname, **pil_kwargs)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2297, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: '/opt/project/model-producer/service/../../tmp/client_plots/1000001/RandomForestClassifier_06-06-2022_19:01:23.png'

2022-06-06 19:01:25,379-ERROR-modelProducerLog-1::file_service|51:: [Errno 2] No such file or directory: '/opt/project/model-producer/service/../../tmp/ml-models'
2022-06-06 19:01:25,386-ERROR-modelProducerLog-1::file_service|56:: [Errno 2] No such file or directory: '/opt/project/model-producer/service/../../tmp/ml-models/regression_models'
2022-06-06 19:01:25,391-ERROR-modelProducerLog-1::file_service|61:: [Errno 2] No such file or directory: '/opt/project/model-producer/service/../../tmp/ml-models/regression_models/1000001'
2022-06-06 19:01:25,395-ERROR-modelProducerLog-1::pipeline_runner|62:: Error in regression pipeline for client: 1000001 , err: [Errno 2] No such file or directory: "/opt/project/model-producer/service/../../tmp/ml-models/regression_models/1000001/06-06-2022_19:01:25.sav'"
2022-06-06 19:01:25,399-ERROR-modelProducerLog-1::pipeline_runner|63:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 60, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 56, in run
    self.persist_model(generated_model)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 166, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/opt/project/model-producer/service/file_service.py", line 33, in persist_model
    model_path, obj_name = dump_model_for_client(model_directory, ad_client_id, model)
  File "/opt/project/model-producer/service/file_service.py", line 64, in dump_model_for_client
    pickle.dump(model, open(model_path, 'wb'))
FileNotFoundError: [Errno 2] No such file or directory: "/opt/project/model-producer/service/../../tmp/ml-models/regression_models/1000001/06-06-2022_19:01:25.sav'"

2022-06-06 19:03:50,251-ERROR-modelProducerLog-1::pipeline_runner|56:: Error in classification pipeline for client: 1000001 , err: Failed to upload /app/service/../tmp/client_plots/1000001/RandomForestClassifier_06-06-2022_19:03:49.png to ml-cashflow-forecast/client_models/RandomForestClassifier_06-06-2022_19:03:49.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-06 19:03:50,266-ERROR-modelProducerLog-1::pipeline_runner|57:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 288, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 103, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 266, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 139, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 162, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 758, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 508, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 911, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 54, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 80, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 152, in evaluate_classifiers
    file_service.persist_classifier_plot(plt, str(type(classifier_params['classifier'][0]).__name__),
  File "/app/service/file_service.py", line 42, in persist_classifier_plot
    if not upload_file(f.name, _ml_models_bucket_key, object_name=obj_name):
  File "/app/service/file_service.py", line 112, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 143, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 294, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /app/service/../tmp/client_plots/1000001/RandomForestClassifier_06-06-2022_19:03:49.png to ml-cashflow-forecast/client_models/RandomForestClassifier_06-06-2022_19:03:49.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-06 19:03:52,682-ERROR-modelProducerLog-1::pipeline_runner|62:: Error in regression pipeline for client: 1000001 , err: Failed to upload /app/service/../tmp/ml-models/regression_models/1000001/06-06-2022_19:03:52.sav' to ml-cashflow-forecast/client_models/06-06-2022_19:03:52.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-06 19:03:52,690-ERROR-modelProducerLog-1::pipeline_runner|63:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 288, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 103, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 266, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 139, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 162, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 758, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 508, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 911, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 60, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 56, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 166, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 35, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key, object_name=obj_name):
  File "/app/service/file_service.py", line 112, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 143, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 294, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /app/service/../tmp/ml-models/regression_models/1000001/06-06-2022_19:03:52.sav' to ml-cashflow-forecast/client_models/06-06-2022_19:03:52.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-06 22:08:14,011-ERROR-modelProducerLog-1::pipeline_runner|56:: Error in classification pipeline for client: 1000001 , err: persist_classifier_plot() missing 1 required positional argument: 'ad_client_id'
2022-06-06 22:08:14,017-ERROR-modelProducerLog-1::pipeline_runner|57:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 54, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 80, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 152, in evaluate_classifiers
    file_service.persist_classifier_plot(plt, str(type(classifier_params['classifier'][0]).__name__),
TypeError: persist_classifier_plot() missing 1 required positional argument: 'ad_client_id'

2022-06-06 22:08:16,118-ERROR-modelProducerLog-1::pipeline_runner|62:: Error in regression pipeline for client: 1000001 , err: Failed to upload /tmp/ml-models/regression_models/1000001/06-06-2022_22:08:15.sav' to ml-cashflow-forecast/client_models/regression_models/1000001/06-06-2022_22:08:15.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-06 22:08:16,131-ERROR-modelProducerLog-1::pipeline_runner|63:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 288, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 103, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 266, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 139, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 162, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 758, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 508, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 911, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 60, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 56, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 166, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 143, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 294, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/ml-models/regression_models/1000001/06-06-2022_22:08:15.sav' to ml-cashflow-forecast/client_models/regression_models/1000001/06-06-2022_22:08:15.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-09 14:08:01,808-ERROR-modelProducerLog-1::pipeline_runner|56:: Error in classification pipeline for client: 1000001 , err: persist_classifier_plot() missing 1 required positional argument: 'ad_client_id'
2022-06-09 14:08:01,815-ERROR-modelProducerLog-1::pipeline_runner|57:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 54, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 77, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 149, in evaluate_classifiers
    file_service.persist_classifier_plot(plt, str(type(classifier_params['classifier'][0]).__name__),
TypeError: persist_classifier_plot() missing 1 required positional argument: 'ad_client_id'

2022-06-09 14:08:05,405-ERROR-modelProducerLog-1::pipeline_runner|62:: Error in regression pipeline for client: 1000001 , err: Unable to locate credentials
2022-06-09 14:08:05,415-ERROR-modelProducerLog-1::pipeline_runner|63:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 60, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 162, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 143, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 288, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 103, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 266, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 139, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 162, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 758, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 508, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 894, in _make_api_call
    http, parsed_response = self._make_request(
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 917, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/usr/local/lib/python3.9/site-packages/botocore/endpoint.py", line 116, in make_request
    return self._send_request(request_dict, operation_model)
  File "/usr/local/lib/python3.9/site-packages/botocore/endpoint.py", line 195, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/usr/local/lib/python3.9/site-packages/botocore/endpoint.py", line 131, in create_request
    self._event_emitter.emit(
  File "/usr/local/lib/python3.9/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/signers.py", line 103, in handler
    return self.sign(operation_name, request)
  File "/usr/local/lib/python3.9/site-packages/botocore/signers.py", line 187, in sign
    auth.add_auth(request)
  File "/usr/local/lib/python3.9/site-packages/botocore/auth.py", line 407, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

2022-06-09 14:11:30,262-ERROR-modelProducerLog-1::pipeline_runner|56:: Error in classification pipeline for client: 1000001 , err: persist_classifier_plot() missing 1 required positional argument: 'ad_client_id'
2022-06-09 14:11:30,274-ERROR-modelProducerLog-1::pipeline_runner|57:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 54, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 77, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 149, in evaluate_classifiers
    file_service.persist_classifier_plot(plt, str(type(classifier_params['classifier'][0]).__name__),
TypeError: persist_classifier_plot() missing 1 required positional argument: 'ad_client_id'

2022-06-09 14:11:32,816-ERROR-modelProducerLog-1::pipeline_runner|62:: Error in regression pipeline for client: 1000001 , err: Unable to locate credentials
2022-06-09 14:11:32,831-ERROR-modelProducerLog-1::pipeline_runner|63:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 60, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 162, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 143, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 288, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 103, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 266, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 139, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 162, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 758, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 508, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 894, in _make_api_call
    http, parsed_response = self._make_request(
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 917, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/usr/local/lib/python3.9/site-packages/botocore/endpoint.py", line 116, in make_request
    return self._send_request(request_dict, operation_model)
  File "/usr/local/lib/python3.9/site-packages/botocore/endpoint.py", line 195, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/usr/local/lib/python3.9/site-packages/botocore/endpoint.py", line 131, in create_request
    self._event_emitter.emit(
  File "/usr/local/lib/python3.9/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/signers.py", line 103, in handler
    return self.sign(operation_name, request)
  File "/usr/local/lib/python3.9/site-packages/botocore/signers.py", line 187, in sign
    auth.add_auth(request)
  File "/usr/local/lib/python3.9/site-packages/botocore/auth.py", line 407, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

2022-06-09 14:12:53,436-ERROR-modelProducerLog-1::pipeline_runner|56:: Error in classification pipeline for client: 1000001 , err: persist_classifier_plot() missing 1 required positional argument: 'ad_client_id'
2022-06-09 14:12:53,444-ERROR-modelProducerLog-1::pipeline_runner|57:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 54, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 77, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 149, in evaluate_classifiers
    file_service.persist_classifier_plot(plt, str(type(classifier_params['classifier'][0]).__name__),
TypeError: persist_classifier_plot() missing 1 required positional argument: 'ad_client_id'

2022-06-09 15:36:07,860-ERROR-modelProducerLog-14::pipeline_runner|70:: Error in classification pipeline for client: 1000001 , err: Failed to upload /tmp/client_plots/1000001/RandomForestClassifier_09-06-2022_15:36:06.png to ml-cashflow-forecast/client_plots/classification_models/1000001/RandomForestClassifier_09-06-2022_15:36:06.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-09 15:36:08,689-ERROR-modelProducerLog-14::pipeline_runner|71:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 68, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 77, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 149, in evaluate_classifiers
    file_service.persist_classifier_plot(plot=plt, pipeline_type=PipelineType.CLASSIFICATION,
  File "/app/service/file_service.py", line 49, in persist_classifier_plot
    if not upload_file(f.name, _ml_plots_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/client_plots/1000001/RandomForestClassifier_09-06-2022_15:36:06.png to ml-cashflow-forecast/client_plots/classification_models/1000001/RandomForestClassifier_09-06-2022_15:36:06.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-09 15:36:17,250-ERROR-modelProducerLog-14::pipeline_runner|76:: Error in regression pipeline for client: 1000001 , err: Failed to upload /tmp/ml-models/regression_models/1000001/09-06-2022_15:36:16.sav' to ml-cashflow-forecast/client_models/regression_models/1000001/09-06-2022_15:36:16.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-09 15:36:17,271-ERROR-modelProducerLog-14::pipeline_runner|77:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 74, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 162, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/ml-models/regression_models/1000001/09-06-2022_15:36:16.sav' to ml-cashflow-forecast/client_models/regression_models/1000001/09-06-2022_15:36:16.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-09 15:37:30,167-ERROR-modelProducerLog-15::pipeline_runner|70:: Error in classification pipeline for client: 1000005 , err: Failed to upload /tmp/client_plots/1000005/RandomForestClassifier_09-06-2022_15:37:29.png to ml-cashflow-forecast/client_plots/classification_models/1000005/RandomForestClassifier_09-06-2022_15:37:29.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-09 15:37:30,514-ERROR-modelProducerLog-15::pipeline_runner|71:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 68, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 77, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 149, in evaluate_classifiers
    file_service.persist_classifier_plot(plot=plt, pipeline_type=PipelineType.CLASSIFICATION,
  File "/app/service/file_service.py", line 49, in persist_classifier_plot
    if not upload_file(f.name, _ml_plots_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/client_plots/1000005/RandomForestClassifier_09-06-2022_15:37:29.png to ml-cashflow-forecast/client_plots/classification_models/1000005/RandomForestClassifier_09-06-2022_15:37:29.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-09 15:37:48,279-ERROR-modelProducerLog-15::pipeline_runner|76:: Error in regression pipeline for client: 1000005 , err: Failed to upload /tmp/ml-models/regression_models/1000005/09-06-2022_15:37:47.sav' to ml-cashflow-forecast/client_models/regression_models/1000005/09-06-2022_15:37:47.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-09 15:37:48,369-ERROR-modelProducerLog-15::pipeline_runner|77:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 74, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 162, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/ml-models/regression_models/1000005/09-06-2022_15:37:47.sav' to ml-cashflow-forecast/client_models/regression_models/1000005/09-06-2022_15:37:47.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-11 09:34:43,543-ERROR-modelProducerLog-17::pipeline_runner|58:: Error in classification pipeline for client: 1000001 , err: log_model_results() missing 2 required positional arguments: 'x_test' and 'y_test'
2022-06-11 09:34:43,928-ERROR-modelProducerLog-17::pipeline_runner|59:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 83, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 178, in evaluate_classifiers
    self.log_model_results(model_state)
TypeError: log_model_results() missing 2 required positional arguments: 'x_test' and 'y_test'

2022-06-11 09:34:51,595-ERROR-modelProducerLog-17::pipeline_runner|65:: Error in regression pipeline for client: 1000001 , err: relation "regression_stats" does not exist
LINE 1: insert into regression_stats (ad_client_id, test_mse, test_r...
                    ^

2022-06-11 09:34:51,609-ERROR-modelProducerLog-17::pipeline_runner|66:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 63, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 67, in run
    self.log_regression_results(test_mse, test_r2, train_r2)
  File "/app/service/regression_pipeline.py", line 186, in log_regression_results
    db_api.execute_statement(sql, (self.ad_client_id, test_mse, test_r2, train_r2))
  File "/app/datasource/db_api.py", line 32, in execute_statement
    cursor.execute(sql, params)
psycopg2.errors.UndefinedTable: relation "regression_stats" does not exist
LINE 1: insert into regression_stats (ad_client_id, test_mse, test_r...
                    ^


2022-06-11 09:37:08,614-ERROR-modelProducerLog-17::pipeline_runner|58:: Error in classification pipeline for client: 1000001 , err: 0
2022-06-11 09:37:09,215-ERROR-modelProducerLog-17::pipeline_runner|59:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 184, in evaluate_classifiers
    best_result = pd.DataFrame(result_list).sort_values(by='best_score', ascending=False)[0]
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 3458, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 0

2022-06-11 09:37:20,174-ERROR-modelProducerLog-17::pipeline_runner|65:: Error in regression pipeline for client: 1000001 , err: relation "regression_stats" does not exist
LINE 1: insert into regression_stats (ad_client_id, test_mse, test_r...
                    ^

2022-06-11 09:37:20,219-ERROR-modelProducerLog-17::pipeline_runner|66:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 63, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 67, in run
    self.log_regression_results(test_mse, test_r2, train_r2)
  File "/app/service/regression_pipeline.py", line 186, in log_regression_results
    db_api.execute_statement(sql, (self.ad_client_id, test_mse, test_r2, train_r2))
  File "/app/datasource/db_api.py", line 32, in execute_statement
    cursor.execute(sql, params)
psycopg2.errors.UndefinedTable: relation "regression_stats" does not exist
LINE 1: insert into regression_stats (ad_client_id, test_mse, test_r...
                    ^


2022-06-11 09:41:46,167-ERROR-modelProducerLog-17::pipeline_runner|58:: Error in classification pipeline for client: 1000001 , err: 'Series' object has no attribute 'classifier_name'
2022-06-11 09:41:46,699-ERROR-modelProducerLog-17::pipeline_runner|59:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 221, in log_model_results
    classifier_name=result_dict.classifier_name,
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5487, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'Series' object has no attribute 'classifier_name'

2022-06-11 09:46:43,301-ERROR-modelProducerLog-15::pipeline_runner|58:: Error in classification pipeline for client: 1000001 , err: 'Series' object has no attribute 'best_estimator_'
2022-06-11 09:46:43,598-ERROR-modelProducerLog-15::pipeline_runner|59:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 216, in log_model_results
    model = result_dict.grid_obj.best_estimator_
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5487, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'Series' object has no attribute 'best_estimator_'

2022-06-11 09:50:17,747-ERROR-modelProducerLog-16::pipeline_runner|58:: Error in classification pipeline for client: 1000005 , err: 'Series' object has no attribute 'best_estimator_'
2022-06-11 09:50:18,110-ERROR-modelProducerLog-16::pipeline_runner|59:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 216, in log_model_results
    model = result_dict.grid_obj.best_estimator_
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5487, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'Series' object has no attribute 'best_estimator_'

2022-06-11 10:10:29,501-ERROR-modelProducerLog-16::pipeline_runner|58:: Error in classification pipeline for client: 1000001 , err: 'DataFrame' object has no attribute 'classifier_name'
2022-06-11 10:10:29,985-ERROR-modelProducerLog-16::pipeline_runner|59:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 221, in log_model_results
    classifier_name=result_dict.classifier_name[0],
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5487, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'classifier_name'

2022-06-11 10:13:15,692-ERROR-modelProducerLog-17::pipeline_runner|58:: Error in classification pipeline for client: 1000005 , err: 'DataFrame' object has no attribute 'classifier_name'
2022-06-11 10:13:16,062-ERROR-modelProducerLog-17::pipeline_runner|59:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 221, in log_model_results
    classifier_name=result_dict.classifier_name[0],
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5487, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'classifier_name'

2022-06-11 10:13:31,311-ERROR-modelProducerLog-17::pipeline_runner|65:: Error in regression pipeline for client: 1000005 , err: Failed to upload /tmp/ml-models/regression_models/1000005/11-06-2022_10:13:30.sav' to ml-cashflow-forecast/client_models/regression_models/1000005/11-06-2022_10:13:30.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-11 10:13:31,345-ERROR-modelProducerLog-17::pipeline_runner|66:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 63, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 63, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 176, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/ml-models/regression_models/1000005/11-06-2022_10:13:30.sav' to ml-cashflow-forecast/client_models/regression_models/1000005/11-06-2022_10:13:30.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-11 10:49:33,877-ERROR-modelProducerLog-15::pipeline_runner|58:: Error in classification pipeline for client: 1000001 , err: 'GridSearchCV' object is not subscriptable
2022-06-11 10:49:34,219-ERROR-modelProducerLog-15::pipeline_runner|59:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 216, in log_model_results
    model = list(result_dict['grid_obj'])[0]['best_estimator_']
TypeError: 'GridSearchCV' object is not subscriptable

2022-06-11 10:50:58,582-ERROR-modelProducerLog-16::pipeline_runner|58:: Error in classification pipeline for client: 1000001 , err: 'classifier_name'
2022-06-11 10:50:59,054-ERROR-modelProducerLog-16::pipeline_runner|59:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'classifier_name'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 221, in log_model_results
    classifier_name=list(result_dict['classifier_name'])[0],
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 3458, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'classifier_name'

2022-06-11 10:59:26,685-ERROR-modelProducerLog-15::pipeline_runner|58:: Error in classification pipeline for client: 1000001 , err: 'classifier_name'
2022-06-11 10:59:27,237-ERROR-modelProducerLog-15::pipeline_runner|59:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 56, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 221, in log_model_results
    classifier_name=result_dict['classifier_name'],
KeyError: 'classifier_name'

2022-06-14 09:16:58,681-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000005 , err: Length mismatch: Expected axis has 91499 elements, new values have 90776 elements
2022-06-14 09:16:59,513-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 51, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 72, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 91499 elements, new values have 90776 elements

2022-06-14 09:17:14,498-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000005 , err: Failed to upload /tmp/ml-models/regression_models/1000005/14-06-2022_09:17:13.sav' to ml-cashflow-forecast/client_models/regression_models/1000005/14-06-2022_09:17:13.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-14 09:17:14,535-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 63, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 176, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/ml-models/regression_models/1000005/14-06-2022_09:17:13.sav' to ml-cashflow-forecast/client_models/regression_models/1000005/14-06-2022_09:17:13.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-14 09:17:20,352-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000001 , err: Failed to upload /tmp/client_plots/1000001/RandomForestClassifier_14-06-2022_09:17:19.png to ml-cashflow-forecast/client_plots/classification_models/1000001/RandomForestClassifier_14-06-2022_09:17:19.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-14 09:17:20,744-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 220, in log_model_results
    file_service.persist_classifier_plot(plot=plt, pipeline_type=PipelineType.CLASSIFICATION,
  File "/app/service/file_service.py", line 49, in persist_classifier_plot
    if not upload_file(f.name, _ml_plots_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/client_plots/1000001/RandomForestClassifier_14-06-2022_09:17:19.png to ml-cashflow-forecast/client_plots/classification_models/1000001/RandomForestClassifier_14-06-2022_09:17:19.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-14 09:17:27,069-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000057 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 09:17:27,103-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 165, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 09:20:36,224-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000005 , err: Length mismatch: Expected axis has 91499 elements, new values have 90776 elements
2022-06-14 09:20:36,830-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 51, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 72, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 91499 elements, new values have 90776 elements

2022-06-14 09:20:50,417-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000005 , err: Failed to upload /tmp/ml-models/regression_models/1000005/14-06-2022_09:20:49.sav' to ml-cashflow-forecast/client_models/regression_models/1000005/14-06-2022_09:20:49.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-14 09:20:50,440-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 63, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 176, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/ml-models/regression_models/1000005/14-06-2022_09:20:49.sav' to ml-cashflow-forecast/client_models/regression_models/1000005/14-06-2022_09:20:49.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-14 09:20:58,377-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000001 , err: Failed to upload /tmp/client_plots/1000001/RandomForestClassifier_14-06-2022_09:20:57.png to ml-cashflow-forecast/client_plots/classification_models/1000001/RandomForestClassifier_14-06-2022_09:20:57.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-14 09:20:58,855-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 185, in evaluate_classifiers
    self.log_model_results(best_result, x_test, y_test)
  File "/app/service/classification_pipeline.py", line 220, in log_model_results
    file_service.persist_classifier_plot(plot=plt, pipeline_type=PipelineType.CLASSIFICATION,
  File "/app/service/file_service.py", line 49, in persist_classifier_plot
    if not upload_file(f.name, _ml_plots_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/client_plots/1000001/RandomForestClassifier_14-06-2022_09:20:57.png to ml-cashflow-forecast/client_plots/classification_models/1000001/RandomForestClassifier_14-06-2022_09:20:57.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-14 09:21:01,462-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000057 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 09:21:01,481-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 84, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 165, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 09:40:03,866-ERROR-modelProducerLog-19::pipeline_runner|61:: Error in classification pipeline for client: 1000005 , err: Length mismatch: Expected axis has 91499 elements, new values have 3242 elements
2022-06-14 09:40:03,905-ERROR-modelProducerLog-19::pipeline_runner|62:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 51, in __init__
    self.__data = self.distribute_data(df)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 72, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 91499 elements, new values have 3242 elements

2022-06-14 09:44:25,171-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000057 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 09:44:25,416-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 85, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 166, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 09:44:28,246-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000057 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:44:28,270-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 57, in run
    test_mse, test_r2 = self.test_model(model_for_test, x_train, y_train, x_test, y_test)
  File "/app/service/regression_pipeline.py", line 112, in test_model
    return cv_alpha_test_error, model.score(x_test, y_test)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 695, in score
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 746, in transform
    Xs = self._fit_transform(
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 853, in _transform_one
    res = transformer.transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 635, in transform
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 496, in transform
    X = self._validate_input(X, in_fit=False)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:44:28,285-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000058 , err: Length mismatch: Expected axis has 2 elements, new values have 0 elements
2022-06-14 09:44:28,305-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 2 elements, new values have 0 elements

2022-06-14 09:44:28,410-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000058 , err: Found array with 0 sample(s) (shape=(0, 27)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:44:28,425-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 27)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:44:28,444-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000184 , err: Length mismatch: Expected axis has 137 elements, new values have 0 elements
2022-06-14 09:44:28,455-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 137 elements, new values have 0 elements

2022-06-14 09:44:31,149-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000189 , err: Length mismatch: Expected axis has 165 elements, new values have 1266 elements
2022-06-14 09:44:31,188-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 165 elements, new values have 1266 elements

2022-06-14 09:44:31,587-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000189 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:44:31,603-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 57, in run
    test_mse, test_r2 = self.test_model(model_for_test, x_train, y_train, x_test, y_test)
  File "/app/service/regression_pipeline.py", line 112, in test_model
    return cv_alpha_test_error, model.score(x_test, y_test)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 695, in score
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 746, in transform
    Xs = self._fit_transform(
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 853, in _transform_one
    res = transformer.transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 635, in transform
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 496, in transform
    X = self._validate_input(X, in_fit=False)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:44:54,961-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000243 , err: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=4.
2022-06-14 09:44:54,988-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 144, in build_model
    lassocv.fit(x_train_transform, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/linear_model/_coordinate_descent.py", line 1703, in fit
    folds = list(cv.split(X, y))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=4.

2022-06-14 09:50:56,616-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000360 , err: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.
2022-06-14 09:50:56,773-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 85, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 156, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 209, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 834, in evaluate_candidates
    for (cand_idx, parameters), (split_idx, (train, test)) in product(
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.

2022-06-14 09:50:56,990-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000360 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:50:57,017-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:50:57,106-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000433 , err: division by zero
2022-06-14 09:50:57,177-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 64, in distribute_data
    step = math.ceil(bigger_len / (lesser_len - 1))
ZeroDivisionError: division by zero

2022-06-14 09:50:57,406-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000433 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:50:57,429-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:50:57,487-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000439 , err: Length mismatch: Expected axis has 33 elements, new values have 87 elements
2022-06-14 09:50:57,532-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 33 elements, new values have 87 elements

2022-06-14 09:50:57,979-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000439 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:50:58,009-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 57, in run
    test_mse, test_r2 = self.test_model(model_for_test, x_train, y_train, x_test, y_test)
  File "/app/service/regression_pipeline.py", line 112, in test_model
    return cv_alpha_test_error, model.score(x_test, y_test)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 695, in score
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 746, in transform
    Xs = self._fit_transform(
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 853, in _transform_one
    res = transformer.transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 635, in transform
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 496, in transform
    X = self._validate_input(X, in_fit=False)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:50:58,078-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000608 , err: Length mismatch: Expected axis has 9 elements, new values have 37 elements
2022-06-14 09:50:58,123-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 9 elements, new values have 37 elements

2022-06-14 09:50:58,277-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000608 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:50:58,305-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:53:02,444-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000839 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 09:53:02,707-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 85, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 166, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 09:53:03,731-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000839 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:53:03,763-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 57, in run
    test_mse, test_r2 = self.test_model(model_for_test, x_train, y_train, x_test, y_test)
  File "/app/service/regression_pipeline.py", line 112, in test_model
    return cv_alpha_test_error, model.score(x_test, y_test)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 695, in score
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 746, in transform
    Xs = self._fit_transform(
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 853, in _transform_one
    res = transformer.transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 635, in transform
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 496, in transform
    X = self._validate_input(X, in_fit=False)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:53:03,791-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000849 , err: Length mismatch: Expected axis has 9 elements, new values have 599 elements
2022-06-14 09:53:03,813-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 9 elements, new values have 599 elements

2022-06-14 09:53:04,007-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000849 , err: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.
2022-06-14 09:53:04,021-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 144, in build_model
    lassocv.fit(x_train_transform, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/linear_model/_coordinate_descent.py", line 1703, in fit
    folds = list(cv.split(X, y))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.

2022-06-14 09:54:23,428-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000868 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0

2022-06-14 09:54:23,446-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 85, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 156, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 209, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0


2022-06-14 09:54:24,565-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000879 , err: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.
2022-06-14 09:54:24,579-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 85, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 156, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 209, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 834, in evaluate_candidates
    for (cand_idx, parameters), (split_idx, (train, test)) in product(
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.

2022-06-14 09:54:24,682-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000879 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:54:24,698-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:54:24,767-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000938 , err: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.
2022-06-14 09:54:24,784-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 85, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 156, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 209, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 834, in evaluate_candidates
    for (cand_idx, parameters), (split_idx, (train, test)) in product(
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.

2022-06-14 09:54:24,885-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000938 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:54:24,906-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:54:24,931-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1001096 , err: Length mismatch: Expected axis has 5 elements, new values have 12 elements
2022-06-14 09:54:24,952-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 5 elements, new values have 12 elements

2022-06-14 09:54:25,031-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1001096 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:54:25,048-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 09:54:51,211-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1001455 , err: Length mismatch: Expected axis has 17 elements, new values have 21 elements
2022-06-14 09:54:51,275-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 17 elements, new values have 21 elements

2022-06-14 09:54:51,488-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1001455 , err: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=3.
2022-06-14 09:54:51,517-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 144, in build_model
    lassocv.fit(x_train_transform, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/linear_model/_coordinate_descent.py", line 1703, in fit
    folds = list(cv.split(X, y))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=3.

2022-06-14 09:54:51,584-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1002406 , err: Length mismatch: Expected axis has 125 elements, new values have 371 elements
2022-06-14 09:54:51,613-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 125 elements, new values have 371 elements

2022-06-14 09:55:39,812-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1003311 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 09:55:39,834-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 85, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 166, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 09:55:40,165-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1003311 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 09:55:40,190-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 57, in run
    test_mse, test_r2 = self.test_model(model_for_test, x_train, y_train, x_test, y_test)
  File "/app/service/regression_pipeline.py", line 112, in test_model
    return cv_alpha_test_error, model.score(x_test, y_test)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 695, in score
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 746, in transform
    Xs = self._fit_transform(
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 853, in _transform_one
    res = transformer.transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 635, in transform
    Xt = transform.transform(Xt)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 496, in transform
    X = self._validate_input(X, in_fit=False)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 10:02:46,420-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1004614 , err: Length mismatch: Expected axis has 93202 elements, new values have 170104 elements
2022-06-14 10:02:46,455-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 93202 elements, new values have 170104 elements

2022-06-14 10:06:28,120-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1005814 , err: Length mismatch: Expected axis has 9062 elements, new values have 439484 elements
2022-06-14 10:06:28,162-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 9062 elements, new values have 439484 elements

2022-06-14 10:07:15,620-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1006312 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0

2022-06-14 10:07:15,648-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 85, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 156, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 209, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0


2022-06-14 10:24:37,521-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1010764 , err: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=5.
2022-06-14 10:24:37,546-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 144, in build_model
    lassocv.fit(x_train_transform, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/linear_model/_coordinate_descent.py", line 1703, in fit
    folds = list(cv.split(X, y))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=5.

2022-06-14 10:24:42,847-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1010864 , err: Length mismatch: Expected axis has 2735 elements, new values have 9045 elements
2022-06-14 10:24:42,899-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 2735 elements, new values have 9045 elements

2022-06-14 10:24:43,140-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1010864 , err: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.
2022-06-14 10:24:43,163-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 144, in build_model
    lassocv.fit(x_train_transform, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/linear_model/_coordinate_descent.py", line 1703, in fit
    folds = list(cv.split(X, y))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.

2022-06-14 10:24:43,355-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1011014 , err: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.
2022-06-14 10:24:43,381-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 85, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 156, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 209, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 834, in evaluate_candidates
    for (cand_idx, parameters), (split_idx, (train, test)) in product(
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.

2022-06-14 10:24:43,624-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1011014 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 10:24:43,645-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 11:04:53,621-ERROR-modelProducerLog-20::pipeline_runner|61:: Error in classification pipeline for client: 1010864 , err: Length mismatch: Expected axis has 2735 elements, new values have 9045 elements
2022-06-14 11:04:53,667-ERROR-modelProducerLog-20::pipeline_runner|62:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 2735 elements, new values have 9045 elements

2022-06-14 11:04:54,202-ERROR-modelProducerLog-20::pipeline_runner|68:: Error in regression pipeline for client: 1010864 , err: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.
2022-06-14 11:04:54,239-ERROR-modelProducerLog-20::pipeline_runner|69:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 148, in build_model
    lassocv.fit(x_train_transform, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/linear_model/_coordinate_descent.py", line 1703, in fit
    folds = list(cv.split(X, y))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.

2022-06-14 11:05:46,909-ERROR-modelProducerLog-19::pipeline_runner|61:: Error in classification pipeline for client: 1010864 , err: Length mismatch: Expected axis has 2735 elements, new values have 9045 elements
2022-06-14 11:05:46,980-ERROR-modelProducerLog-19::pipeline_runner|62:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/opt/project/model-producer/service/classification_pipeline.py", line 73, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 2735 elements, new values have 9045 elements

2022-06-14 11:05:47,279-ERROR-modelProducerLog-19::pipeline_runner|68:: Error in regression pipeline for client: 1010864 , err: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.
2022-06-14 11:05:47,297-ERROR-modelProducerLog-19::pipeline_runner|69:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 148, in build_model
    lassocv.fit(x_train_transform, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/linear_model/_coordinate_descent.py", line 1703, in fit
    folds = list(cv.split(X, y))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.

2022-06-14 11:10:31,251-ERROR-modelProducerLog-19::pipeline_runner|69:: Error in regression pipeline for client: 1010864 , err: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.
2022-06-14 11:10:31,286-ERROR-modelProducerLog-19::pipeline_runner|70:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 67, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 148, in build_model
    lassocv.fit(x_train_transform, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/linear_model/_coordinate_descent.py", line 1703, in fit
    folds = list(cv.split(X, y))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=10 greater than the number of samples: n_samples=9.

2022-06-14 11:11:10,289-ERROR-modelProducerLog-16::pipeline_runner|69:: Error in regression pipeline for client: 1010864 , err: Failed to upload /tmp/ml-models/regression_models/1010864/14-06-2022_11:11:09.sav' to ml-cashflow-forecast/client_models/regression_models/1010864/14-06-2022_11:11:09.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-06-14 11:11:10,489-ERROR-modelProducerLog-16::pipeline_runner|70:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 67, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 63, in run
    self.persist_model(generated_model)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 180, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/opt/project/model-producer/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/opt/project/model-producer/service/file_service.py", line 121, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/ml-models/regression_models/1010864/14-06-2022_11:11:09.sav' to ml-cashflow-forecast/client_models/regression_models/1010864/14-06-2022_11:11:09.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-06-14 12:10:51,099-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000057 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 12:10:51,319-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 169, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 12:11:30,422-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000057 , err: maximum recursion depth exceeded while calling a Python object
2022-06-14 12:11:30,512-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    x_train, y_train, x_test, y_test = self.split_for_test()
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  [Previous line repeated 948 more times]
  File "/app/service/regression_pipeline.py", line 87, in split_for_test
    x_train.fillna(value=x_train.mean(), inplace=True)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10751, in mean
    return NDFrame.mean(self, axis, skipna, level, numeric_only, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10369, in mean
    return self._stat_function(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10354, in _stat_function
    return self._reduce(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9851, in _reduce
    res, _ = df._mgr.reduce(blk_func, ignore_failures=ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 1283, in reduce
    nbs = blk.reduce(func, ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 141, in newfunc
    return self.split_and_operate(meth, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 505, in split_and_operate
    rbs = func(nb, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 1809, in reduce
    res = func(self.values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9823, in blk_func
    return op(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 94, in _f
    return f(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 156, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 411, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 650, in nanmean
    values, mask, dtype, dtype_max, _ = _get_values(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 309, in _get_values
    mask = _maybe_get_mask(values, skipna, mask)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 253, in _maybe_get_mask
    mask = isna(values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 138, in isna
    return _isna(obj)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 171, in _isna
    return _isna_array(obj, inf_as_na=inf_as_na)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 245, in _isna_array
    elif is_string_dtype(dtype):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 571, in is_string_dtype
    return _is_dtype(arr_or_dtype, condition)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 1540, in _is_dtype
    return condition(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 562, in condition
    return dtype.kind in ("O", "S", "U") and not is_excluded_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in is_excluded_dtype
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in <genexpr>
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 455, in is_period_dtype
    return PeriodDtype.is_dtype(arr_or_dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/dtypes.py", line 969, in is_dtype
    return super().is_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/base.py", line 289, in is_dtype
    if isinstance(dtype, (ABCSeries, ABCIndex, ABCDataFrame, np.dtype)):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/generic.py", line 45, in _check
    return getattr(inst, attr, "_typ") in comp
RecursionError: maximum recursion depth exceeded while calling a Python object

2022-06-14 12:11:30,671-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000058 , err: Length mismatch: Expected axis has 2 elements, new values have 0 elements
2022-06-14 12:11:30,683-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 77, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 2 elements, new values have 0 elements

2022-06-14 12:11:30,814-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000058 , err: Found array with 0 sample(s) (shape=(0, 27)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 12:11:30,846-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 27)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 12:11:30,907-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000184 , err: Length mismatch: Expected axis has 137 elements, new values have 0 elements
2022-06-14 12:11:30,925-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 77, in distribute_data
    df1.index = df1_idx
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 137 elements, new values have 0 elements

2022-06-14 12:11:51,256-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000189 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 12:11:51,287-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 169, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 12:12:19,437-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000189 , err: maximum recursion depth exceeded while calling a Python object
2022-06-14 12:12:19,475-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    x_train, y_train, x_test, y_test = self.split_for_test()
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  [Previous line repeated 948 more times]
  File "/app/service/regression_pipeline.py", line 87, in split_for_test
    x_train.fillna(value=x_train.mean(), inplace=True)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10751, in mean
    return NDFrame.mean(self, axis, skipna, level, numeric_only, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10369, in mean
    return self._stat_function(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10354, in _stat_function
    return self._reduce(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9851, in _reduce
    res, _ = df._mgr.reduce(blk_func, ignore_failures=ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 1283, in reduce
    nbs = blk.reduce(func, ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 141, in newfunc
    return self.split_and_operate(meth, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 505, in split_and_operate
    rbs = func(nb, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 1809, in reduce
    res = func(self.values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9823, in blk_func
    return op(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 94, in _f
    return f(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 156, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 411, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 650, in nanmean
    values, mask, dtype, dtype_max, _ = _get_values(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 309, in _get_values
    mask = _maybe_get_mask(values, skipna, mask)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 253, in _maybe_get_mask
    mask = isna(values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 138, in isna
    return _isna(obj)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 171, in _isna
    return _isna_array(obj, inf_as_na=inf_as_na)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 245, in _isna_array
    elif is_string_dtype(dtype):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 571, in is_string_dtype
    return _is_dtype(arr_or_dtype, condition)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 1540, in _is_dtype
    return condition(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 562, in condition
    return dtype.kind in ("O", "S", "U") and not is_excluded_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in is_excluded_dtype
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in <genexpr>
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 455, in is_period_dtype
    return PeriodDtype.is_dtype(arr_or_dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/dtypes.py", line 969, in is_dtype
    return super().is_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/base.py", line 289, in is_dtype
    if isinstance(dtype, (ABCSeries, ABCIndex, ABCDataFrame, np.dtype)):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/generic.py", line 45, in _check
    return getattr(inst, attr, "_typ") in comp
RecursionError: maximum recursion depth exceeded while calling a Python object

2022-06-14 12:17:33,047-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000360 , err: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.
2022-06-14 12:17:33,372-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 159, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 212, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 834, in evaluate_candidates
    for (cand_idx, parameters), (split_idx, (train, test)) in product(
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.

2022-06-14 12:17:33,469-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000360 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 12:17:33,499-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 12:17:33,525-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000433 , err: division by zero
2022-06-14 12:17:33,540-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 52, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 64, in distribute_data
    step = math.ceil(bigger_len / (lesser_len - 1))
ZeroDivisionError: division by zero

2022-06-14 12:17:33,626-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000433 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 12:17:33,646-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 12:17:38,868-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000439 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 12:17:38,881-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 169, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 12:17:56,611-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000608 , err: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.
2022-06-14 12:17:56,628-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 159, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 212, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 834, in evaluate_candidates
    for (cand_idx, parameters), (split_idx, (train, test)) in product(
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.

2022-06-14 12:17:56,833-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1000608 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 12:17:56,854-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 12:18:09,965-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000439 , err: maximum recursion depth exceeded while calling a Python object
2022-06-14 12:18:10,045-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    x_train, y_train, x_test, y_test = self.split_for_test()
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  [Previous line repeated 948 more times]
  File "/app/service/regression_pipeline.py", line 87, in split_for_test
    x_train.fillna(value=x_train.mean(), inplace=True)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10751, in mean
    return NDFrame.mean(self, axis, skipna, level, numeric_only, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10369, in mean
    return self._stat_function(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10354, in _stat_function
    return self._reduce(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9851, in _reduce
    res, _ = df._mgr.reduce(blk_func, ignore_failures=ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 1283, in reduce
    nbs = blk.reduce(func, ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 141, in newfunc
    return self.split_and_operate(meth, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 505, in split_and_operate
    rbs = func(nb, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 1809, in reduce
    res = func(self.values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9823, in blk_func
    return op(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 94, in _f
    return f(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 156, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 411, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 650, in nanmean
    values, mask, dtype, dtype_max, _ = _get_values(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 309, in _get_values
    mask = _maybe_get_mask(values, skipna, mask)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 253, in _maybe_get_mask
    mask = isna(values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 138, in isna
    return _isna(obj)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 171, in _isna
    return _isna_array(obj, inf_as_na=inf_as_na)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 245, in _isna_array
    elif is_string_dtype(dtype):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 571, in is_string_dtype
    return _is_dtype(arr_or_dtype, condition)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 1540, in _is_dtype
    return condition(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 562, in condition
    return dtype.kind in ("O", "S", "U") and not is_excluded_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in is_excluded_dtype
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in <genexpr>
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 455, in is_period_dtype
    return PeriodDtype.is_dtype(arr_or_dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/dtypes.py", line 969, in is_dtype
    return super().is_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/base.py", line 289, in is_dtype
    if isinstance(dtype, (ABCSeries, ABCIndex, ABCDataFrame, np.dtype)):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/generic.py", line 45, in _check
    return getattr(inst, attr, "_typ") in comp
RecursionError: maximum recursion depth exceeded while calling a Python object

2022-06-14 12:18:59,740-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000839 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 12:18:59,772-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 169, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 12:19:27,917-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000839 , err: maximum recursion depth exceeded while calling a Python object
2022-06-14 12:19:27,950-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    x_train, y_train, x_test, y_test = self.split_for_test()
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  [Previous line repeated 948 more times]
  File "/app/service/regression_pipeline.py", line 87, in split_for_test
    x_train.fillna(value=x_train.mean(), inplace=True)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10751, in mean
    return NDFrame.mean(self, axis, skipna, level, numeric_only, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10369, in mean
    return self._stat_function(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10354, in _stat_function
    return self._reduce(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9851, in _reduce
    res, _ = df._mgr.reduce(blk_func, ignore_failures=ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 1283, in reduce
    nbs = blk.reduce(func, ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 141, in newfunc
    return self.split_and_operate(meth, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 505, in split_and_operate
    rbs = func(nb, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 1809, in reduce
    res = func(self.values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9823, in blk_func
    return op(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 94, in _f
    return f(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 156, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 411, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 650, in nanmean
    values, mask, dtype, dtype_max, _ = _get_values(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 309, in _get_values
    mask = _maybe_get_mask(values, skipna, mask)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 253, in _maybe_get_mask
    mask = isna(values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 138, in isna
    return _isna(obj)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 171, in _isna
    return _isna_array(obj, inf_as_na=inf_as_na)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 245, in _isna_array
    elif is_string_dtype(dtype):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 571, in is_string_dtype
    return _is_dtype(arr_or_dtype, condition)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 1540, in _is_dtype
    return condition(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 562, in condition
    return dtype.kind in ("O", "S", "U") and not is_excluded_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in is_excluded_dtype
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in <genexpr>
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 455, in is_period_dtype
    return PeriodDtype.is_dtype(arr_or_dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/dtypes.py", line 969, in is_dtype
    return super().is_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/base.py", line 289, in is_dtype
    if isinstance(dtype, (ABCSeries, ABCIndex, ABCDataFrame, np.dtype)):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/generic.py", line 45, in _check
    return getattr(inst, attr, "_typ") in comp
RecursionError: maximum recursion depth exceeded while calling a Python object

2022-06-14 12:19:40,509-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000849 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 12:19:40,533-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 169, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 12:20:08,729-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000849 , err: maximum recursion depth exceeded while calling a Python object
2022-06-14 12:20:08,755-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    x_train, y_train, x_test, y_test = self.split_for_test()
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  [Previous line repeated 948 more times]
  File "/app/service/regression_pipeline.py", line 87, in split_for_test
    x_train.fillna(value=x_train.mean(), inplace=True)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10751, in mean
    return NDFrame.mean(self, axis, skipna, level, numeric_only, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10369, in mean
    return self._stat_function(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10354, in _stat_function
    return self._reduce(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9851, in _reduce
    res, _ = df._mgr.reduce(blk_func, ignore_failures=ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 1283, in reduce
    nbs = blk.reduce(func, ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 141, in newfunc
    return self.split_and_operate(meth, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 505, in split_and_operate
    rbs = func(nb, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 1809, in reduce
    res = func(self.values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9823, in blk_func
    return op(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 94, in _f
    return f(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 156, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 411, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 650, in nanmean
    values, mask, dtype, dtype_max, _ = _get_values(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 309, in _get_values
    mask = _maybe_get_mask(values, skipna, mask)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 253, in _maybe_get_mask
    mask = isna(values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 138, in isna
    return _isna(obj)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 171, in _isna
    return _isna_array(obj, inf_as_na=inf_as_na)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 245, in _isna_array
    elif is_string_dtype(dtype):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 571, in is_string_dtype
    return _is_dtype(arr_or_dtype, condition)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 1540, in _is_dtype
    return condition(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 562, in condition
    return dtype.kind in ("O", "S", "U") and not is_excluded_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in is_excluded_dtype
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in <genexpr>
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 455, in is_period_dtype
    return PeriodDtype.is_dtype(arr_or_dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/dtypes.py", line 969, in is_dtype
    return super().is_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/base.py", line 289, in is_dtype
    if isinstance(dtype, (ABCSeries, ABCIndex, ABCDataFrame, np.dtype)):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/generic.py", line 45, in _check
    return getattr(inst, attr, "_typ") in comp
RecursionError: maximum recursion depth exceeded while calling a Python object

2022-06-14 12:20:52,588-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000868 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0

2022-06-14 12:20:52,607-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 159, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 212, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0


2022-06-14 12:20:53,575-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000879 , err: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.
2022-06-14 12:20:53,592-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 159, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 212, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 834, in evaluate_candidates
    for (cand_idx, parameters), (split_idx, (train, test)) in product(
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.

2022-06-14 12:20:53,668-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000879 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 12:20:53,686-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 12:20:53,748-ERROR-modelProducerLog-18::pipeline_runner|61:: Error in classification pipeline for client: 1000938 , err: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.
2022-06-14 12:20:53,775-ERROR-modelProducerLog-18::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 159, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 212, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 834, in evaluate_candidates
    for (cand_idx, parameters), (split_idx, (train, test)) in product(
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.

2022-06-14 12:20:53,808-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1001096 , err: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.
2022-06-14 12:20:53,826-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 159, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 212, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 834, in evaluate_candidates
    for (cand_idx, parameters), (split_idx, (train, test)) in product(
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 333, in split
    raise ValueError(
ValueError: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=0.

2022-06-14 12:20:53,865-ERROR-modelProducerLog-18::pipeline_runner|68:: Error in regression pipeline for client: 1000938 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 12:20:53,883-ERROR-modelProducerLog-18::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 12:20:53,908-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1001096 , err: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.
2022-06-14 12:20:53,925-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 139, in build_model
    x_train_transform = data_transformer.fit_transform(x_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 673, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/usr/local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 1043, in __call__
    if self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 117, in __call__
    return self.function(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 870, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 422, in fit_transform
    return last_step.fit_transform(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 345, in fit
    X = self._validate_input(X, in_fit=True)
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 304, in _validate_input
    raise ve
  File "/usr/local/lib/python3.9/site-packages/sklearn/impute/_base.py", line 287, in _validate_input
    X = self._validate_data(
  File "/usr/local/lib/python3.9/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py", line 909, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 28)) while a minimum of 1 is required by SimpleImputer.

2022-06-14 12:21:05,473-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1001455 , err: k-fold cross-validation requires at least one train/test split by setting n_splits=2 or more, got n_splits=1.
2022-06-14 12:21:05,537-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 55, in run
    model_for_test, _ = self.build_model(x_train, y_train)
  File "/app/service/regression_pipeline.py", line 148, in build_model
    lassocv.fit(x_train_transform, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/linear_model/_coordinate_descent.py", line 1700, in fit
    cv = check_cv(self.cv)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 2320, in check_cv
    return KFold(cv)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 435, in __init__
    super().__init__(n_splits=n_splits, shuffle=shuffle, random_state=random_state)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_split.py", line 286, in __init__
    raise ValueError(
ValueError: k-fold cross-validation requires at least one train/test split by setting n_splits=2 or more, got n_splits=1.

2022-06-14 12:22:10,965-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1003311 , err: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 12:22:10,994-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 89, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 169, in evaluate_classifiers
    'auc': metrics.roc_auc_score(y_test, y_pred),
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 569, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 338, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.

2022-06-14 12:22:41,287-ERROR-modelProducerLog-17::pipeline_runner|68:: Error in regression pipeline for client: 1003311 , err: maximum recursion depth exceeded while calling a Python object
2022-06-14 12:22:41,377-ERROR-modelProducerLog-17::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 52, in run
    x_train, y_train, x_test, y_test = self.split_for_test()
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  File "/app/service/regression_pipeline.py", line 92, in split_for_test
    return self.split_for_test(n_days=int(n_days / 2))
  [Previous line repeated 948 more times]
  File "/app/service/regression_pipeline.py", line 87, in split_for_test
    x_train.fillna(value=x_train.mean(), inplace=True)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10751, in mean
    return NDFrame.mean(self, axis, skipna, level, numeric_only, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10369, in mean
    return self._stat_function(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/generic.py", line 10354, in _stat_function
    return self._reduce(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9851, in _reduce
    res, _ = df._mgr.reduce(blk_func, ignore_failures=ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 1283, in reduce
    nbs = blk.reduce(func, ignore_failures)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 141, in newfunc
    return self.split_and_operate(meth, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 505, in split_and_operate
    rbs = func(nb, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 1809, in reduce
    res = func(self.values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/frame.py", line 9823, in blk_func
    return op(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 94, in _f
    return f(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 156, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 411, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 650, in nanmean
    values, mask, dtype, dtype_max, _ = _get_values(
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 309, in _get_values
    mask = _maybe_get_mask(values, skipna, mask)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/nanops.py", line 253, in _maybe_get_mask
    mask = isna(values)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 138, in isna
    return _isna(obj)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 171, in _isna
    return _isna_array(obj, inf_as_na=inf_as_na)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/missing.py", line 245, in _isna_array
    elif is_string_dtype(dtype):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 571, in is_string_dtype
    return _is_dtype(arr_or_dtype, condition)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 1540, in _is_dtype
    return condition(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 562, in condition
    return dtype.kind in ("O", "S", "U") and not is_excluded_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in is_excluded_dtype
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 569, in <genexpr>
    return any(is_excluded(dtype) for is_excluded in is_excluded_checks)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/common.py", line 455, in is_period_dtype
    return PeriodDtype.is_dtype(arr_or_dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/dtypes.py", line 969, in is_dtype
    return super().is_dtype(dtype)
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/base.py", line 289, in is_dtype
    if isinstance(dtype, (ABCSeries, ABCIndex, ABCDataFrame, np.dtype)):
  File "/usr/local/lib/python3.9/site-packages/pandas/core/dtypes/generic.py", line 45, in _check
    return getattr(inst, attr, "_typ") in comp
RecursionError: maximum recursion depth exceeded while calling a Python object

2022-06-14 12:59:13,586-ERROR-modelProducerLog-16::classification_pipeline|191:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 12:59:13,800-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000057 , err: index 1 is out of bounds for axis 1 with size 1
2022-06-14 12:59:13,811-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 203, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-06-14 12:59:14,180-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 12:59:17,209-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000058 , err: Classification Exception: Only one class found in data
2022-06-14 12:59:17,219-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 70, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 77, in distribute_data
    raise OnlyOneClassException()
service.classification_pipeline.OnlyOneClassException: Classification Exception: Only one class found in data

2022-06-14 12:59:17,266-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 12:59:17,290-ERROR-modelProducerLog-16::pipeline_runner|68:: Error in regression pipeline for client: 1000058 , err: Regression Exception: Not enough training data
2022-06-14 12:59:17,306-ERROR-modelProducerLog-16::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 80, in run
    generated_model, train_r2 = self.build_model(*self.split_for_train())
  File "/app/service/regression_pipeline.py", line 139, in build_model
    raise NotEnoughDataException()
service.regression_pipeline.NotEnoughDataException: Regression Exception: Not enough training data

2022-06-14 12:59:17,323-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000184 , err: Classification Exception: Only one class found in data
2022-06-14 12:59:17,337-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 70, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 77, in distribute_data
    raise OnlyOneClassException()
service.classification_pipeline.OnlyOneClassException: Classification Exception: Only one class found in data

2022-06-14 12:59:27,329-ERROR-modelProducerLog-16::classification_pipeline|191:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 12:59:27,354-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000189 , err: index 1 is out of bounds for axis 1 with size 1
2022-06-14 12:59:27,368-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 203, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-06-14 12:59:27,675-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:05:14,592-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000360 , err: Classification Exception: Not enough training data
2022-06-14 13:05:14,620-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 182, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 232, in train_model_grid
    raise NotEnoughDataException()
service.classification_pipeline.NotEnoughDataException: Classification Exception: Not enough training data

2022-06-14 13:05:14,733-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:05:29,257-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000433 , err: division by zero
2022-06-14 13:05:29,290-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 70, in __init__
    self.__data = self.distribute_data(df)
  File "/app/service/classification_pipeline.py", line 84, in distribute_data
    step = math.ceil(bigger_len / (lesser_len - 1))
ZeroDivisionError: division by zero

2022-06-14 13:05:29,458-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:05:52,338-ERROR-modelProducerLog-16::classification_pipeline|191:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 13:05:52,395-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000439 , err: index 1 is out of bounds for axis 1 with size 1
2022-06-14 13:05:52,415-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 203, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-06-14 13:05:52,902-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:05:53,741-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000608 , err: Classification Exception: Not enough training data
2022-06-14 13:05:53,771-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 182, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 232, in train_model_grid
    raise NotEnoughDataException()
service.classification_pipeline.NotEnoughDataException: Classification Exception: Not enough training data

2022-06-14 13:05:53,884-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:07:30,486-ERROR-modelProducerLog-17::classification_pipeline|191:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 13:07:30,865-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000839 , err: index 1 is out of bounds for axis 1 with size 1
2022-06-14 13:07:30,876-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 203, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-06-14 13:07:31,164-ERROR-modelProducerLog-17::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:07:37,919-ERROR-modelProducerLog-17::classification_pipeline|191:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 13:07:37,936-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000849 , err: index 1 is out of bounds for axis 1 with size 1
2022-06-14 13:07:37,946-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 203, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-06-14 13:07:38,202-ERROR-modelProducerLog-17::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:08:48,483-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000868 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0

2022-06-14 13:08:48,513-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 182, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 247, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0


2022-06-14 13:08:49,489-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000879 , err: Classification Exception: Not enough training data
2022-06-14 13:08:49,503-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 182, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 232, in train_model_grid
    raise NotEnoughDataException()
service.classification_pipeline.NotEnoughDataException: Classification Exception: Not enough training data

2022-06-14 13:08:49,556-ERROR-modelProducerLog-17::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:08:50,487-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1000938 , err: Classification Exception: Not enough training data
2022-06-14 13:08:50,502-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 182, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 232, in train_model_grid
    raise NotEnoughDataException()
service.classification_pipeline.NotEnoughDataException: Classification Exception: Not enough training data

2022-06-14 13:08:50,539-ERROR-modelProducerLog-17::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:08:51,217-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1001096 , err: Classification Exception: Not enough training data
2022-06-14 13:08:51,240-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 182, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 232, in train_model_grid
    raise NotEnoughDataException()
service.classification_pipeline.NotEnoughDataException: Classification Exception: Not enough training data

2022-06-14 13:08:51,319-ERROR-modelProducerLog-17::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:09:08,402-ERROR-modelProducerLog-17::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:10:12,403-ERROR-modelProducerLog-17::classification_pipeline|191:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-06-14 13:10:12,442-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1003311 , err: index 1 is out of bounds for axis 1 with size 1
2022-06-14 13:10:12,461-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 203, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-06-14 13:10:12,769-ERROR-modelProducerLog-17::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-06-14 13:31:03,744-ERROR-modelProducerLog-17::pipeline_runner|61:: Error in classification pipeline for client: 1006312 , err: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0

2022-06-14 13:31:03,784-ERROR-modelProducerLog-17::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 182, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 247, in train_model_grid
    grid.fit(x_train, y_train)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/usr/local/lib/python3.9/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_classes.py", line 257, in fit
    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(
  File "/usr/local/lib/python3.9/site-packages/sklearn/svm/_base.py", line 1162, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1.0


2022-06-14 13:52:23,187-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1011014 , err: Classification Exception: Not enough training data
2022-06-14 13:52:23,231-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 182, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 232, in train_model_grid
    raise NotEnoughDataException()
service.classification_pipeline.NotEnoughDataException: Classification Exception: Not enough training data

2022-06-14 13:52:23,362-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-07-06 21:04:57,463-ERROR-modelProducerLog-16::classification_pipeline|191:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-07-06 21:04:57,691-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000001 , err: index 1 is out of bounds for axis 1 with size 1
2022-07-06 21:04:57,702-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/opt/project/model-producer/service/classification_pipeline.py", line 203, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-07-06 21:04:58,259-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-11-17 13:42:30,364-ERROR-modelProducerLog-16::classification_pipeline|191:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-11-17 13:42:30,838-ERROR-modelProducerLog-16::pipeline_runner|61:: Error in classification pipeline for client: 1000001 , err: index 1 is out of bounds for axis 1 with size 1
2022-11-17 13:42:30,870-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 203, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-11-17 13:42:33,474-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-11-17 13:42:46,579-ERROR-modelProducerLog-16::pipeline_runner|68:: Error in regression pipeline for client: 1000001 , err: Failed to upload /tmp/ml-models/regression_models/1000001/17-11-2022_13:42:45.sav' to ml-cashflow-forecast/client_models/regression_models/1000001/17-11-2022_13:42:45.sav: An error occurred (InvalidToken) when calling the PutObject operation: The provided token is malformed or otherwise invalid.
2022-11-17 13:42:46,641-ERROR-modelProducerLog-16::pipeline_runner|69:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (InvalidToken) when calling the PutObject operation: The provided token is malformed or otherwise invalid.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 81, in run
    self.persist_model(generated_model)
  File "/app/service/regression_pipeline.py", line 202, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/app/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/app/service/file_service.py", line 112, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/ml-models/regression_models/1000001/17-11-2022_13:42:45.sav' to ml-cashflow-forecast/client_models/regression_models/1000001/17-11-2022_13:42:45.sav: An error occurred (InvalidToken) when calling the PutObject operation: The provided token is malformed or otherwise invalid.

2022-11-17 16:05:33,083-ERROR-modelProducerLog-16::classification_pipeline|261:: Could not generate classifier plot: Failed to upload /tmp/client_plots/1000298/RandomForestClassifier_17-11-2022_16:05:32.png to ml-cashflow-forecast/client_plots/classification_models/1000298/RandomForestClassifier_17-11-2022_16:05:32.png: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-11-17 16:05:33,453-ERROR-modelProducerLog-16::pipeline_runner|61:: Unable to generate classification model for the client: 1000298 , err: build_model() takes 4 positional arguments but 6 were given
2022-11-17 16:05:33,469-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/classification_pipeline.py", line 114, in run
    model = self.build_model(best_params, *self.split_for_test())
TypeError: build_model() takes 4 positional arguments but 6 were given

2022-11-17 16:05:44,391-ERROR-modelProducerLog-16::pipeline_runner|68:: Unable to generate a regression model for the client: 1000298 , err: Failed to upload /tmp/ml-models/regression_models/1000298/17-11-2022_16:05:43.sav' to ml-cashflow-forecast/client_models/regression_models/1000298/17-11-2022_16:05:43.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.
2022-11-17 16:05:44,411-ERROR-modelProducerLog-16::pipeline_runner|69:: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/usr/local/lib/python3.9/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/usr/local/lib/python3.9/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 316, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.9/site-packages/botocore/client.py", line 635, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/project/model-producer/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/opt/project/model-producer/service/regression_pipeline.py", line 81, in run
    self.persist_model(generated_model)
  File "/opt/project/model-producer/service/regression_pipeline.py", line 202, in persist_model
    file_service.persist_model(PipelineType.REGRESSION, model, self.ad_client_id)
  File "/opt/project/model-producer/service/file_service.py", line 36, in persist_model
    if not upload_file(f.name, _ml_models_bucket_key + '/' + model_directory + '/' + str(ad_client_id), object_name=obj_name):
  File "/opt/project/model-producer/service/file_service.py", line 112, in upload_file
    response = s3_client.upload_file(file_name, bucket, _object_name)
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/inject.py", line 129, in upload_file
    return transfer.upload_file(
  File "/usr/local/lib/python3.9/site-packages/boto3/s3/transfer.py", line 285, in upload_file
    raise S3UploadFailedError(
boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/ml-models/regression_models/1000298/17-11-2022_16:05:43.sav' to ml-cashflow-forecast/client_models/regression_models/1000298/17-11-2022_16:05:43.sav: An error occurred (ExpiredToken) when calling the PutObject operation: The provided token has expired.

2022-12-09 14:53:09,426-ERROR-modelProducerLog-16::classification_pipeline|189:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-12-09 14:53:09,834-ERROR-modelProducerLog-16::pipeline_runner|61:: Unable to generate classification model for the client: 1000013 , err: index 1 is out of bounds for axis 1 with size 1
2022-12-09 14:53:09,844-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 201, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-12-09 14:53:10,094-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-12-09 14:53:10,110-ERROR-modelProducerLog-16::pipeline_runner|68:: Unable to generate a regression model for the client: 1000013 , err: Regression Exception: Not enough training data
2022-12-09 14:53:10,119-ERROR-modelProducerLog-16::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 80, in run
    generated_model, train_r2 = self.build_model(*self.split_for_train())
  File "/app/service/regression_pipeline.py", line 139, in build_model
    raise NotEnoughDataException()
service.regression_pipeline.NotEnoughDataException: Regression Exception: Not enough training data

2022-12-09 14:53:25,899-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-12-09 14:53:30,502-ERROR-modelProducerLog-15::classification_pipeline|189:: Unable to generate ROC curve: Only one class present in y_true. ROC AUC score is not defined in that case.
2022-12-09 14:53:30,718-ERROR-modelProducerLog-15::pipeline_runner|61:: Unable to generate classification model for the client: 1000017 , err: index 1 is out of bounds for axis 1 with size 1
2022-12-09 14:53:30,732-ERROR-modelProducerLog-15::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 201, in evaluate_classifiers
    'FP': _confusion_matrix[0, 1],
IndexError: index 1 is out of bounds for axis 1 with size 1

2022-12-09 14:53:31,020-ERROR-modelProducerLog-15::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-12-09 14:53:53,555-ERROR-modelProducerLog-16::pipeline_runner|61:: Unable to generate classification model for the client: 1000623 , err: Classification Exception: Not enough training data
2022-12-09 14:53:53,579-ERROR-modelProducerLog-16::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 180, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 230, in train_model_grid
    raise NotEnoughDataException()
service.classification_pipeline.NotEnoughDataException: Classification Exception: Not enough training data

2022-12-09 14:53:53,654-ERROR-modelProducerLog-16::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-12-09 14:54:13,220-ERROR-modelProducerLog-15::pipeline_runner|61:: Unable to generate classification model for the client: 1000628 , err: Classification Exception: Not enough training data
2022-12-09 14:54:13,239-ERROR-modelProducerLog-15::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 180, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 230, in train_model_grid
    raise NotEnoughDataException()
service.classification_pipeline.NotEnoughDataException: Classification Exception: Not enough training data

2022-12-09 14:54:13,339-ERROR-modelProducerLog-15::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-12-09 14:54:48,691-ERROR-modelProducerLog-15::pipeline_runner|61:: Unable to generate classification model for the client: 1001303 , err: Classification Exception: Not enough training data
2022-12-09 14:54:48,706-ERROR-modelProducerLog-15::pipeline_runner|62:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 59, in run_pipelines
    classification_result = ClassificationPipeline(data, ad_client_id).run()
  File "/app/service/classification_pipeline.py", line 109, in run
    best_params = self.evaluate_classifiers(*self.split_for_test())
  File "/app/service/classification_pipeline.py", line 180, in evaluate_classifiers
    grid = self.train_model_grid(classifier_params, x_train, y_train)
  File "/app/service/classification_pipeline.py", line 230, in train_model_grid
    raise NotEnoughDataException()
service.classification_pipeline.NotEnoughDataException: Classification Exception: Not enough training data

2022-12-09 14:54:48,753-ERROR-modelProducerLog-15::regression_pipeline|74:: Unable to test model: Regression Exception: Not enough training data
2022-12-09 14:54:48,795-ERROR-modelProducerLog-15::pipeline_runner|68:: Unable to generate a regression model for the client: 1001303 , err: Regression Exception: Not enough training data
2022-12-09 14:54:48,824-ERROR-modelProducerLog-15::pipeline_runner|69:: Traceback (most recent call last):
  File "/app/service/pipeline_runner.py", line 66, in run_pipelines
    regression_result = RegressionPipeline(data, ad_client_id).run()
  File "/app/service/regression_pipeline.py", line 80, in run
    generated_model, train_r2 = self.build_model(*self.split_for_train())
  File "/app/service/regression_pipeline.py", line 139, in build_model
    raise NotEnoughDataException()
service.regression_pipeline.NotEnoughDataException: Regression Exception: Not enough training data

2022-12-12 11:07:19,034-ERROR-modelProducerLog-1::db|45:: got error could not connect to server: Connection refused
	Is the server running on host "scloud-dev-aurora-2020-10-21-f.cluster-clx3mwuakln3.eu-central-1.rds.amazonaws.com" (3.124.207.197) and accepting
	TCP/IP connections on port 5432?. reconnecting 1
